(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0b30ad"],{"274f":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("XsStackBlock",{ref:"XsStackBlock",attrs:{storeClassify:"",stackKey:"wlpStackId",detailQuerymethod:t.detailQuerymethod,storeType:t.storeType,title:t.title,api:t.api,bottomButtons:t.bottomButtons,tableCondition:t.tableCondition,selectItems:t.selectItems,customFixedField3:!0,showPivot:!1,footerText:t.footerText,footIcon:t.footIcon,checkallable:!0,fixedField:t.fixedField,numberCol:t.numberCol},on:{aftersearch:t.aftersearch,bottomButtonsClick:t.bottomButtonsClick,beforesearchSelect:t.beforesearchSelect,aftercheckall:t.aftercheckall,footIconClick:t.footIconClick},scopedSlots:t._u([{key:"totalInfo",fn:function(){return[a("van-row",{attrs:{type:"flex"}},[a("van-col",{staticStyle:{"white-space":"nowrap"},attrs:{span:"8"}},[a("label",[t._v(t._s(t.$t("oriStock.stackTitle")))]),a("span",[t._v(t._s(t.WmsStackMatSum.matStackQty+"/"+t.total))])]),a("van-col",{staticStyle:{"white-space":"nowrap"},attrs:{span:"8"}},[a("label",[t._v(t._s(t.$t("oriStock.matNum")))]),a("span",[t._v(t._s(t.WmsStackMatSum.matSumQty))])]),a("van-col",{staticStyle:{"white-space":"nowrap"},attrs:{span:"8"}},[a("label",[t._v(t._s(t.$t("oriStock.matWeight")))]),a("span",[t._v(t._s(t.tool.numberFormat("3",t.WmsStackMatSum.matSumWeight)+t.$t("oriStock.KG")))])])],1)]},proxy:!0}])}),a("van-popup",{style:{width:"100%",height:"100%",backgroundColor:"#F7F7F7"},attrs:{position:"right"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[t.show?a("basePage",{ref:"basePage",attrs:{rightIcon:"",title:t.$t("semiProductStock.detailTitle"),btnMethod:t.btnMethod,buttons:t.buttons,onePage:!0,customFixedField3:!0,selectItems:t.selectItems,showFooter:!0,checkable:!0,checkallable:!0,footerText:t.footerText1},on:{aftercheck:t.aftercheck,buttonsClick:t.buttonsClick,onClickLeft:t.onClickLeft,beforequery:t.beforequery,aftercheckall:t.aftercheck}}):t._e(),a("stackSelect",{ref:"outOfStock",attrs:{api:t.api,show:t.showOutOfStock,storeType:3,showPivot:!1,fixedField:t.fixedField},on:{closeSelect:t.closeSelect,sure:t.sureTransferStock,aftersearch:t.aftersearch1}})],1),a("van-popup",{style:{width:"100%",height:"100%",backgroundColor:"#F7F7F7"},attrs:{position:"right"},model:{value:t.show2,callback:function(e){t.show2=e},expression:"show2"}},[a("stackSelect",{ref:"outOfStock1",attrs:{api:t.api,show:t.show2,storeType:3,showPivot:!1,fixedField:t.fixedField},on:{closeSelect:t.closeSelect2,sure:t.sureTransferStock1,aftersearch:t.aftersearch1}})],1)],1)},o=[],r=(a("386d"),a("ac6a"),a("02df")),i={name:"semiProductStock",props:{tableCondition:{type:Array,default:function(){return[]}}},components:{},data:function(){return{children:[],footerText1:[{key:"partsReportReportNumber",display:this.$t("pretreatment.matNumName"),value:0},{key:"partsReportWeight",display:this.$t("pretreatment.matWeightName"),value:"0",unit:"KG"}],showOutOfStock:!1,show2:!1,buttons:[{key:"transferStore",name:this.$t("semiProductStock.transferStore")}],numberCol:{},tool:r["a"],fixedField:["matSumQty","matSumWeight"],btnMethod:{querymethod:"/nest/nestsemiorder/autopagedetail"},title:this.$t("semiProductStock.title"),storeType:3,api:"/nest/nestwiplineparts/getpartsrootstack",detailQuerymethod:"/nest/nestsemiorder/autopagegroup",getStackSumByConApi:"/wms/wmspretreatmenttask/getstacksumbycon",btnmenus:[],bottomButtons:[{key:"transfer",name:this.$t("outboundRecommendation.transfer")}],slaves:{},selectItems:{ptmtSignStatus:[{id:"0",name:this.$t("lineSideLibrary.unsigned")},{id:"1",name:this.$t("lineSideLibrary.signed")}],overdueFlag:[{id:"0",name:this.$t("lineSideLibrary.notOverdue")},{id:"1",name:this.$t("lineSideLibrary.overdue")}],overdue:[{id:"0",name:this.$t("lineSideLibrary.notOverdue")},{id:"1",name:this.$t("lineSideLibrary.overdue")}]},serialnoStr:"ptmtInSerialno",WmsStackMatSum:{matStackQty:0,matSumCount:0,matSumQty:0,matSumThickness:0,matSumWeight:0},total:0,show:!1,footIcon:!0,footerText:[{key:"partsReportReportNumber",fix:0,display:this.$t("pretreatment.matNumName"),value:0},{key:"partsReportWeight",display:this.$t("pretreatment.matWeightName"),fix:r["a"].getAccuracy("4"),value:"0.0",unit:this.$t("oriStock.KG")}],selectedData:{}}},methods:{aftercheck:function(){var t=this.$refs.basePage.getselected();this.footerText1.forEach((function(e){var a=0;t.forEach((function(t){a+=parseFloat(t[e.key])})),"partsReportReportNumber"===e.key&&(e.value=r["a"].numberFormat(3,a)),"partsReportWeight"===e.key&&(e.value=r["a"].numberFormat(4,a))})),this.$emit("aftercheck",t)},sureTransferStock:function(t){var e=this,a=this,s=this.$refs.basePage.getselected();this.$toast.loading({forbidClick:!0,duration:0});var o=[];s.forEach((function(e){var a={wlrWlpId:e.id,wlrFromStoreid:e.wlpStoreId,wlrFromStackid:e.wlpStackId,wlrQuatity:e.partsReportReportNumber,wlrToStoreid:t.storeId,wlrToStackid:t.stackId,wlrBussType:"6",wlrDeviceid:"",wlrRemark:"半成品移库"};o.push(a)})),this.$ajax("/nest/nestwiplineparts/batchcollapse","",o,(function(){e.$toast.success(a.$t("semiProductStock.transferStoreSuccess")),a.$refs.basePage.search(),a.$refs.XsStackBlock.$refs.XsStackDetail.$refs.basePage.search(),e.showOutOfStock=!1}))},closeSelect:function(t){t&&(t.flag=!1),this.showStackSelect=!1,this.showTransfer=!1,this.showOutOfStock=!1},closeSelect2:function(t){t&&(t.flag=!1),this.show2=!1},buttonsClick:function(t){if("transferStore"===t){var e=this.$refs.basePage.getselected();e&&e.length>0?this.showOutOfStock=!0:this.$toast.fail(this.$t("base.noselect"))}},onClickLeft:function(t){this.show=!1,t.flag=!1},beforequery:function(t,e){e.value["parent"]=this.selectedData,e.exp["parent"]="detail"},footIconClick:function(t){this.selectedData=t,this.show=!0},aftercheckall:function(){if(!0===this.$refs.XsStackBlock.$refs.XsStackDetail.$refs.basePage.checkAll){this.footerText[0].value=this.$refs.XsStackBlock.$refs.XsStackDetail.$refs.basePage.extParams.totalNum;var t=this.$refs.XsStackBlock.$refs.XsStackDetail.$refs.basePage.extParams.totalWeight;this.footerText[1].value=r["a"].numberFormat("4",t)+this.$t("oriStock.KG")}else this.footerText[0].value=0,this.footerText[1].value="0.0"},initSelect:function(){var t=this;this.$ajax("/common/comteam/list","",{},(function(e){var a=[];e.data.data.forEach((function(t){var e={id:t.id,name:t.teamName};a.push(e)})),t.selectItems.partsReportTeamId=a})),this.$ajax("/auth/dep/listdep","",{},(function(e){var a=[];e.data.data.forEach((function(t){var e={id:t.id,name:t.depName};a.push(e)})),t.selectItems.partsReportWorkshop=a})),this.$ajax("/common/comequipment/list","",{},(function(e){var a=[];e.data.data.forEach((function(t){var e={id:t.id,name:t.equipmentName};a.push(e)})),t.selectItems.partsReportEquipment=a})),this.$ajax("/auth/user/listuser","",{},(function(e){var a=[];e.data.data.forEach((function(t){var e={id:t.id,name:t.userRealname};a.push(e)})),t.selectItems.partsReportUserId=a})),this.$ajax("/wms/wmsstack/list","",{},(function(e){var a=[];e.data.data.forEach((function(t){var e={name:t.stackName,id:t.id};a.push(e)})),t.selectItems.wlpStackId=a})),this.$ajax("/wms/wmsstore/list","",{storeType:3},(function(e){var a=[];e.data.data.forEach((function(t){var e={id:t.id,name:t.storeName};a.push(e)})),t.selectItems.wlpStoreId=a})),this.selectItems.ptmtStatus=r["a"].getDict("PTMT_TASK_STATUS"),this.selectItems.oboBusscode=r["a"].getDict("ODB_BUSS_CODE"),this.selectItems.matSheetType=r["a"].getDict("NEST_MAT_TYPE"),this.selectItems.partsReportCuttingType=r["a"].getDict("CUTTING_TYPE"),this.selectItems["partsReportFeedback"]=r["a"].getDict("NEST_FEEDBACK_STATUS")},sure:function(){},beforesearchSelect:function(t){t.slaves=this.slaves},aftersearch:function(t){this.WmsStackMatSum=t.extParams.WmsStackMatSum,this.total=t.total,t.records.forEach((function(t){t.wmsStackList.forEach((function(t){t.stackmodelMaterialclass="WIP"}))}))},aftersearch1:function(t){var e=this;t.records.forEach((function(t){t.wmsStackList.forEach((function(t){e.$refs.XsStackBlock.selectedStackId===t.id&&(t.isCurrentItem=!0),t.matSumWeight=r["a"].numberFormat("4",t.matSumWeight),t.matSumQty=r["a"].numberFormat("3",t.matSumQty)}))}))},bottomButtonsClick:function(t){var e=this;arguments.length>1&&void 0!==arguments[1]&&arguments[1],arguments.length>2&&void 0!==arguments[2]&&arguments[2];"transfer"===t&&this.selectChildren((function(t){t&&(e.show2=!0)}))},selectChildren:function(t){var e=this,a=this.$refs.XsStackBlock.$refs.XsStackDetail.$refs.basePage.getsearchJson(),s=this.$refs.XsStackBlock.$refs.XsStackDetail.$refs.basePage.getselected(),o={autoConditionEntity:a,nestWipLinepartsVos:s};this.$ajax("/nest/nestwiplineparts/selectChildrenBatchAsync","",o,(function(a){e.children=a.data.data,t(e.children)}))},sureTransferStock1:function(t){this.$toast.loading({forbidClick:!0,duration:0});var e=this.children,a=[];e.forEach((function(e){var s={wlrWlpId:e.id,wlrFromStoreid:e.wlpStoreId,wlrFromStackid:e.wlpStackId,wlrQuatity:e.wlpQuatity,wlrToStoreid:t.storeId,wlrToStackid:t.stackId,wlrBussType:"6",wlrDeviceid:"",wlrRemark:"半成品移库"};a.push(s)}));var s=this;this.$ajax("/nest/nestwiplineparts/batchcollapse","",a,(function(){s.$refs.XsStackBlock.$refs.XsStackDetail.$refs.basePage.search(),s.$toast.success(s.$t("semiProductStock.transferStoreSuccess")),s.show2=!1,s.children.splice(0)}))},signFor:function(t){var e=this,a=this,s=t.map((function(t){return{id:t.id}}));this.$ajax("/wms/wmspretreatmenttask/signfor","",s,(function(t){e.$toast.success(a.$t("lineSideLibrary.signSuccess")),a.$refs.stackBlock.detailSearch()}))},delivery:function(t){var e=this,a=this,s=t.map((function(t){return{id:t.id,woCode:t.woCode}}));this.$ajax("/wms/wmspretreatmenttask/delivery","",s,(function(t){e.$toast.success(a.$t("lineSideLibrary.deliverySuccess")),a.$refs.stackBlock.detailSearch()}))}},created:function(){this.initSelect()}},c=i,n=a("2877"),l=Object(n["a"])(c,s,o,!1,null,null,null);e["default"]=l.exports}}]);