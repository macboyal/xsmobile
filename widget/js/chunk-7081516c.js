(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7081516c"],{"29ee":function(t,e,i){},"32c3":function(t,e,i){"use strict";var n=i("c1ce"),o=i.n(n);o.a},"4d31":function(t,e,i){},"80da":function(t,e,i){},c1ce:function(t,e,i){},c690:function(t,e,i){"use strict";var n=i("80da"),o=i.n(n);o.a},ddd7:function(t,e,i){"use strict";var n=i("4d31"),o=i.n(n);o.a},e30a:function(t,e,i){"use strict";var n=i("29ee"),o=i.n(n);o.a},e4cc:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("historyPage",{ref:"historyPage",attrs:{title:t.$t("partHistory.title"),showLeftArrow:t.showLeftArrow,btnMethod:t.btnMethod,queryParams:t.queryParams,showDetailTitle:t.$t("partHistory.showDetail"),screenHeight:t.screenHeight}})],1)},o=[],a=(i("4917"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{attrs:{id:"nav"}},[n("van-nav-bar",{ref:"navBar",staticClass:"bar",attrs:{id:"vanNavBar",fixed:"","left-arrow":t.showLeftArrow},on:{"click-left":t.onClickLeft},scopedSlots:t._u([{key:"title",fn:function(){return[n("span",{staticStyle:{color:"#fff"},attrs:{size:"18"}},[t._v("\n           "+t._s(t.title)+"\n         ")])]},proxy:!0}])})],1),n("div",{staticClass:"body",style:{height:t.bodyheight-5+"PX",top:t.top+3+"PX"},attrs:{id:"body"}},[n("div",[n("div",{staticClass:"main-body"},[n("baseCard",{ref:"cards",attrs:{baseUrl:t.baseUrl,showDetailTitle:t.showDetailTitle+" >",fixed1Tip:t.fixed1Tip,numberCol:t.numberCol,customFixedField3:t.customFixedField3,fixedField:t.fixedField,selectItems:t.selectItems,cardField:t.cardField,cardbuttons:t.cardbuttons,footIcon:t.footIcon,checkable:t.checkable,data:t.localdatas[0]},on:{openDetail:t.openDetail,footIconClick:t.footIconClick}}),t.showLoading?n("loading"):t._e(),n("div",{ref:"tabs"},[n("van-tabs",{attrs:{color:"rgb(97,64,141)","title-active-color":"rgb(97,64,141)"},on:{click:t.bottomTabsClick}},t._l(t.bottom,(function(e){return n("van-tab",{key:e.title,attrs:{title:e.title}},["normal"===e.type?[n("div",{style:{height:!0===e.footer?t.tabsHeight-t.tabbarHeight+"PX":t.tabsHeight+"PX",top:t.tabsTop+5+"PX",overflow:"auto"}},[n("van-cell-group",t._l(e.detail,(function(e){return n("van-field",{key:e.key,staticStyle:{"align-items":"center",overflow:"auto"},attrs:{label:e.title,readonly:""},scopedSlots:t._u(["input"===e.type?{key:"input",fn:function(){return[t._v("\n                        "+t._s(e.value?e.value:"")+"\n                      ")]},proxy:!0}:"number"===e.type?{key:"input",fn:function(){return[t._v("\n                        "+t._s(t.fomatFloat(e.key,e.value))+"\n                      ")]},proxy:!0}:"date"===e.type?{key:"input",fn:function(){return[t._v(" "+t._s(e.value?e.value:"")+"\n                      ")]},proxy:!0}:"image"===e.type?{key:"input",fn:function(){return[n("van-image",{attrs:{height:"3.2rem",fit:"contain",src:t.baseUrl+e.value},scopedSlots:t._u([{key:"loading",fn:function(){return[n("van-loading",{attrs:{type:"spinner",size:"20"}})]},proxy:!0},{key:"error",fn:function(){return[n("div")]},proxy:!0}],null,!0)})]},proxy:!0}:{key:"input",fn:function(){return[t._v("\n                        "+t._s(e.value?e.value:"")+"\n                      ")]},proxy:!0}],null,!0)})})),1)],1),!0===e.footer?[!0===e.footer?n("van-tabbar",{ref:"tabbar",refInFor:!0,model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},[n("van-tabbar-item",[n("van-button",{style:{width:t.bodyWidth/4+"PX"},attrs:{color:"rgb(251, 205, 5)",size:"small"},on:{click:t.openNestDiagram}},[t._v("\n                        套料图\n                      ")])],1),n("van-tabbar-item",[n("van-button",{style:{width:t.bodyWidth/4+"PX"},attrs:{color:"rgb(251, 205, 5)",size:"small"},on:{click:t.openNestNC}},[t._v("\n                        N C\n                      ")])],1),n("van-tabbar-item",[n("van-button",{style:{width:t.bodyWidth/4+"PX"},attrs:{color:"rgb(251, 205, 5)",size:"small"},on:{click:t.openNestDetail}},[t._v("\n                        明 细\n                      ")])],1)],1):t._e()]:t._e()]:"collapse"===e.type?[n("div",{style:{height:t.tabsHeight+"PX",top:t.tabsTop+5+"PX",overflow:"auto"}},[n("van-collapse",{attrs:{accordion:""},model:{value:t.collapseTitle,callback:function(e){t.collapseTitle=e},expression:"collapseTitle"}},t._l(e.detail,(function(e,i){return n("van-collapse-item",{key:e.id,attrs:{title:"板材"+(i+1),name:e.id}},[n("van-cell-group",t._l(e.showValues,(function(e){return n("van-field",{key:e.key,staticStyle:{"align-items":"center",overflow:"auto"},attrs:{label:e.title,readonly:""},scopedSlots:t._u(["input"===e.type?{key:"input",fn:function(){return[t._v("\n                            "+t._s(e.value?e.value:"")+"\n                          ")]},proxy:!0}:"number"===e.type?{key:"input",fn:function(){return[t._v("\n                            "+t._s(t.fomatFloat(e.key,e.value))+"\n                          ")]},proxy:!0}:"date"===e.type?{key:"input",fn:function(){return[t._v(" "+t._s(e.value?e.value:"")+"\n                          ")]},proxy:!0}:"image"===e.type?{key:"input",fn:function(){return[n("van-image",{attrs:{height:"3.2rem",fit:"contain",src:t.baseUrl+e.value},scopedSlots:t._u([{key:"loading",fn:function(){return[n("van-loading",{attrs:{type:"spinner",size:"20"}})]},proxy:!0},{key:"error",fn:function(){return[n("div")]},proxy:!0}],null,!0)})]},proxy:!0}:{key:"input",fn:function(){return[t._v("\n                            "+t._s(e.value?e.value:"")+"\n                          ")]},proxy:!0}],null,!0)})})),1)],1)})),1)],1)]:t._e()],2)})),1)],1)],1)])]),n("van-image",{directives:[{name:"show",rawName:"v-show",value:t.showbody,expression:"showbody"}],ref:"image",staticClass:"img",style:{top:t.imagetop+"px"},attrs:{src:i("cf05"),fit:"contain"}}),n("div",{attrs:{id:"baseDetails"}},[n("van-popup",{staticClass:"baseDetail",style:{width:"100%",height:"100%",backgroundColor:"#F7F7F7"},attrs:{position:"right",transition:"van-fade",duration:"0.3"},model:{value:t.showDetail,callback:function(e){t.showDetail=e},expression:"showDetail"}},[t.showDetail?n("blankPage",{ref:"showDetail",attrs:{title:t.detailtitle?t.detailtitle:t.title+this.$t("base.detail")},on:{onClickLeft:t.close},scopedSlots:t._u([{key:"body",fn:function(){return[n("div",{staticStyle:{height:"100%"}},[n("van-cell-group",t._l(t.cols,(function(e){return n("van-field",{key:e.colkey,staticStyle:{"align-items":"center"},attrs:{label:e.coldisplay,readonly:""},scopedSlots:t._u(["input"===e.coltype?{key:"input",fn:function(){return[t._v("\n                  "+t._s(t.detaildata[e.colkey]?t.detaildata[e.colkey]:"")+"\n                ")]},proxy:!0}:"number"===e.coltype?{key:"input",fn:function(){return[t._v("\n                  "+t._s(t.fomatFloat(e.colkey,t.detaildata[e.colkey]))+"\n                ")]},proxy:!0}:"select"===e.coltype?{key:"input",fn:function(){return[t._v("\n                  "+t._s(t.tableKV[e.colkey]?t.tableKV[e.colkey][t.detaildata[e.colkey]]:"")+"\n                ")]},proxy:!0}:"date"===e.coltype?{key:"input",fn:function(){return[t._v(" "+t._s(t.detaildata[e.colkey])+"\n                ")]},proxy:!0}:"image"===e.coltype?{key:"input",fn:function(){return[n("van-image",{attrs:{height:"3.2rem",fit:"contain",src:t.baseUrl+t.detaildata[e.colkey]},scopedSlots:t._u([{key:"loading",fn:function(){return[n("van-loading",{attrs:{type:"spinner",size:"20"}})]},proxy:!0},{key:"error",fn:function(){return[n("div")]},proxy:!0}],null,!0)})]},proxy:!0}:{key:"input",fn:function(){return[t._v("\n                  "+t._s(t.detaildata[e.colkey])+"\n                ")]},proxy:!0}],null,!0)})})),1)],1)]},proxy:!0}],null,!1,2698567178)}):t._e()],1)],1),n("div",{attrs:{id:"nestDiagram"}},[n("van-popup",{staticClass:"baseDetail",style:{width:"100%",height:"100%",backgroundColor:"#F7F7F7"},attrs:{position:"right",transition:"van-fade",duration:"0.3"},model:{value:t.showNestDiagram,callback:function(e){t.showNestDiagram=e},expression:"showNestDiagram"}},[n("blankPage",{ref:"nestDiagramPage",attrs:{title:t.$t("partHistory.nestDiagramShowTitle")},on:{onClickLeft:t.closeNestDiagram},scopedSlots:t._u([{key:"body",fn:function(){return[n("div",{style:{height:t.bodyheight-5+"PX",overflow:"auto"}},[n("van-swipe",{style:{height:t.bodyheight-10+"PX",top:"3PX",backgroundColor:"#F7F7F7"}},t._l(t.nestDiagramList,(function(e,i){return n("van-swipe-item",{key:i},[n("div",[n("van-image",{staticStyle:{"text-align":"center"},attrs:{src:e,fit:"contain",width:t.bodyWidth,height:t.bodyheight-10}})],1)])})),1)],1)]},proxy:!0}])})],1)],1),n("div",{attrs:{id:"nestNC"}},[n("van-popup",{staticClass:"baseDetail",style:{width:"100%",height:"100%",backgroundColor:"#F7F7F7"},attrs:{position:"right",transition:"van-fade",duration:"0.3"},model:{value:t.showNestNC,callback:function(e){t.showNestNC=e},expression:"showNestNC"}},[n("blankPage",{ref:"nestNCPage",attrs:{title:"查看NC"},on:{onClickLeft:t.closeNestNC},scopedSlots:t._u([{key:"body",fn:function(){return[n("div",{style:{height:t.ncHeight+20+"PX",overflow:"auto"}},[n("van-swipe",{style:{height:t.ncHeight+20+"PX",top:"3PX",backgroundColor:"#F7F7F7"}},t._l(t.nestNCList,(function(e,i){return n("van-swipe-item",{key:i},[n("div",[n("ncText",{ref:"ncText",refInFor:!0,attrs:{url:e,height:t.ncHeight}})],1)])})),1)],1)]},proxy:!0}])})],1)],1),n("div",{attrs:{id:"nestDetail"}},[n("van-popup",{staticClass:"baseDetail",style:{width:"100%",height:"100%",backgroundColor:"#F7F7F7"},attrs:{position:"right",transition:"van-fade",duration:"0.3"},model:{value:t.showNestDetail,callback:function(e){t.showNestDetail=e},expression:"showNestDetail"}},[t.showNestDetail?n("blankPage",{ref:"nestDetailPage",attrs:{title:"查看明细"},on:{onClickLeft:t.closeNestDetail},scopedSlots:t._u([{key:"body",fn:function(){return[n("div",{staticStyle:{height:"100%"}},[n("van-tabs",{attrs:{color:"rgb(97,64,141)","title-active-color":"rgb(97,64,141)"}},t._l(t.nestDetailTitles,(function(e){return n("van-tab",{key:e.title,attrs:{title:e.title}},[n("div",{style:{height:t.tableHeight+"PX",top:t.tableTop+5+"PX","overflow-x":"auto"}},[n("vantTable",{attrs:{tableData:e.datas,headers:e.headers,tableHeight:t.tableHeight,tableTop:t.tableTop}})],1)])})),1)],1)]},proxy:!0}],null,!1,2584772142)}):t._e()],1)],1)],1)}),l=[],r=(i("7f7f"),i("c698"),i("456d"),i("386d"),i("ac6a"),i("c5f6"),i("7618")),s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"text",style:{height:t.height+"PX"},domProps:{innerHTML:t._s(t.txt)}})},c=[],u=i("66df"),d={name:"ncText",data:function(){return{txt:""}},methods:{myAjax:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(t){},a=arguments.length>5?arguments[5]:void 0,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"post",r="",s=localStorage.getItem("serviceCfg");if(s){var c=JSON.parse(s),d=c.facObj;c.cloudObj;!0===d.isDefault&&(r="http://"+d.ip+":"+d.port)}""==r&&(r="http://"+window.location.host);var h=u["a"].create();h({method:l,url:r+e+t,data:i,headers:{"Content-Type":"application/json; charset=utf-8",xs_view:a,access_token:localStorage.getItem("token"),token_uuid:localStorage.getItem("token_uuid")}}).then((function(t){n(t)})).catch((function(t){o(t)}))}},props:{url:{type:String,default:function(){return""}},height:{type:Number,default:function(){return 400}},baseUrl:{type:String,default:function(){return""}}},mounted:function(){var t=this;this.myAjax("/filesmgnt/download/downfilegetstring?fileId="+this.url,"","",(function(e){t.txt=e.data.data}),(function(){}),"","get")},watch:{}},h=d,y=(i("32c3"),i("2877")),p=Object(y["a"])(h,s,c,!1,null,"72b2b8f8",null),f=p.exports,m=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"vant-table"},[i("table",{staticClass:"table",style:t.styleObj,attrs:{cellspacing:"0"}},[i("thead",[i("tr",t._l(t.headers,(function(e,n){return i("th",{key:n,staticClass:"th"},[t._v("\n          "+t._s(e.title)+"\n        ")])})),0)]),i("tbody",{staticClass:"tbody",attrs:{id:"tbody"}},t._l(t.tableData,(function(e,n){return i("tr",{key:n,staticClass:"list-tr"},t._l(t.headers,(function(n,o){return i("td",{key:o,staticClass:"td"},[t._v("\n          "+t._s(e[n.key])+"\n        ")])})),0)})),0)])])},b=[],g={name:"vantTable",props:{styleObj:{type:Object,default:function(){return{width:this.bodyWidth+"PX","font-size":"16px"}}},tableData:{type:Array,default:function(){return[]}},headers:{type:Array,default:function(){return[]}},tableHeight:{type:Number,default:function(){return 0}},tableTop:{type:Number,default:function(){return[]}}},data:function(){return{bodyWidth:0}},created:function(){},mounted:function(){this.bodyWidth=window.innerWidth-3}},k=g,v=(i("e30a"),Object(y["a"])(k,m,b,!1,null,"26fc32eb",null)),w=v.exports,x=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"loading"},[i("van-loading",{attrs:{type:"spinner"}})],1)},C=[],N=i("2b0e"),P=i("543e");N["a"].use(P["a"]);var _={name:"Loading",components:{Loading:P["a"]}},S=_,D=(i("c690"),Object(y["a"])(S,x,C,!1,null,"35e5bd1c",null)),T=D.exports,M={name:"historyPage",props:{btnMethod:{type:Object,default:function(){return{}}},queryParams:{type:Object,default:function(){return{}}},screenHeight:{type:Number,default:function(){return 0}},xsView:{type:String},btnmenus:{type:Array,default:function(){return[]}},buttons:{type:Array,default:function(){return[]}},cardbuttons:{type:Array,default:function(){return[]}},cascadeItems:{type:Object,default:function(){return{}}},checkable:{type:Boolean,default:function(){return!1}},checkallable:{type:Boolean,default:function(){return!0}},contitle:{type:String,default:function(){return this.$t("base.conditions")}},showDetailTitle:{type:String},customFixedField3:{type:Boolean,default:function(){return!1}},detailtitle:{type:String,default:function(){return""}},extIcon:{type:String,default:function(){return""}},fixed3Item:{type:Array,default:function(){return null}},fixedQueryConditions:{type:Array,default:function(){return[]}},defualtConditions:{type:Array,default:function(){return[]}},footIcon:{type:Boolean,default:function(){return!1}},footerText:{type:Array,default:function(){return[]}},immediateQuery:{type:Boolean,default:function(){return!0}},moduleid:{type:String,default:function(){return""}},numberCol:{type:Object},order:{type:Object,default:function(){return{}}},pcmoduleid:{type:String,default:function(){return""}},primaryKey:{type:String,default:function(){return"id"}},rightIcon:{type:String,default:function(){return""}},showLeftArrow:{type:Boolean,default:function(){return!1}},showFooter:{type:Boolean,default:function(){return!0}},singleChoice:{type:Boolean,default:function(){return!1}},tableCondition:{type:Array,default:function(){return[]}},title:{type:String,default:function(){return""}},fixed1Tip:{type:String,default:function(){return""}}},components:{ncText:f,vantTable:w,loading:T},data:function(){return{refreshing:!1,localdatas:[],showbody:!0,cols:[],selectItems:{mbomTaskStatus:[{id:"2",name:"未套料"},{id:"3",name:"套料中"},{id:"4",name:"已套料"},{id:"6",name:"已报工"}],processStatus:[{id:"0",name:"未提交"},{id:"1",name:"审核中"},{id:"2",name:"审核通过"},{id:"3",name:"审核不通过"},{id:"4",name:"已发布"},{id:"5",name:"驳回"}]},cardcols:[{name:"项目号",position:0,type:"input",key:"mbomField1"},{name:"物料编码",position:0,type:"input",key:"mbomCode"},{name:"物料名称",position:0,type:"input",key:"mbomCname"},{name:"材质",position:0,type:"input",key:"matMataMata"},{name:"条形码",position:1,key:"barcode"},{name:"缩略图",position:5,key:"mbomSpicAddr"}],detailcols:[{colkey:"mbomSpicAddr",coltype:"image",coldisplay:"缩略图",colwidth:150,collang:"zh_cn",colselectid:"0",colfix:0},{colkey:"mbomTaskStatus",coltype:"select",coldisplay:"状态",colwidth:150,collang:"zh_cn",colselectid:"0",colfix:0},{colkey:"mbomField1",coltype:"input",coldisplay:"工程号",colwidth:150,collang:"zh_cn",colselectid:"0",colfix:0},{colkey:"mbomField2",coltype:"input",coldisplay:"部套号",colwidth:150,collang:"zh_cn",colselectid:"0",colfix:0},{colkey:"mbomCode",coltype:"input",coldisplay:"物料编码",colwidth:150,collang:"zh_cn",colselectid:"0",colfix:0},{colkey:"mbomCname",coltype:"input",coldisplay:"物料名称",colwidth:150,collang:"zh_cn",colselectid:"0",colfix:0},{colkey:"mbomName",coltype:"input",coldisplay:"物料号",colwidth:150,collang:"zh_cn",colselectid:"0",colfix:0},{colkey:"matMataMata",coltype:"input",coldisplay:"材质",colwidth:150,collang:"zh_cn",colselectid:"0",colfix:0},{colkey:"mbomThickness",coltype:"number",coldisplay:"厚度",colwidth:150,collang:"zh_cn",colselectid:"0",colfix:0},{colkey:"mbomBasicQuantity",coltype:"number",coldisplay:"计划数量",colwidth:150,collang:"zh_cn",colselectid:"0",colfix:0},{colkey:"mbomNestQuantity",coltype:"number",coldisplay:"已套数量",colwidth:150,collang:"zh_cn",colselectid:"0",colfix:0},{colkey:"createTime",coltype:"date",coldisplay:"计划开始时间",colwidth:150,collang:"zh_cn",colselectid:"0",colfix:0},{colkey:"partsReportReportNumber",coltype:"number",coldisplay:"报工数量",colwidth:150,collang:"zh_cn",colselectid:"0",colfix:0},{colkey:"partsReportScrappedNumber",coltype:"number",coldisplay:"报废数量",colwidth:150,collang:"zh_cn",colselectid:"0",colfix:0},{colkey:"tobeStoredNumber",coltype:"number",coldisplay:"待入库数量",colwidth:150,collang:"zh_cn",colselectid:"0",colfix:0},{colkey:"toStoredNumber",coltype:"number",coldisplay:"入库数量",colwidth:150,collang:"zh_cn",colselectid:"0",colfix:0},{colkey:"outStoredNumber",coltype:"number",coldisplay:"出库数量",colwidth:150,collang:"zh_cn",colselectid:"0",colfix:0},{colkey:"inStoredNumber",coltype:"number",coldisplay:"在库数量",colwidth:150,collang:"zh_cn",colselectid:"0",colfix:0},{colkey:"mbomSpecs",coltype:"input",coldisplay:"规格",colwidth:150,collang:"zh_cn",colselectid:"0",colfix:0},{colkey:"mbomLength",coltype:"number",coldisplay:"长度",colwidth:150,collang:"zh_cn",colselectid:"0",colfix:0},{colkey:"mbomWidth",coltype:"number",coldisplay:"宽度",colwidth:150,collang:"zh_cn",colselectid:"0",colfix:0},{colkey:"mbomPri",coltype:"input",coldisplay:"优先级",colwidth:150,collang:"zh_cn",colselectid:"0",colfix:0},{colkey:"mbomBasicUnit",coltype:"input",coldisplay:"主单位",colwidth:150,collang:"zh_cn",colselectid:"0",colfix:0},{colkey:"mbomAuxUnit",coltype:"input",coldisplay:"辅单位",colwidth:150,collang:"zh_cn",colselectid:"0",colfix:0},{colkey:"mbomAuxQuantity",coltype:"number",coldisplay:"辅单位数量",colwidth:150,collang:"zh_cn",colselectid:"0",colfix:0},{colkey:"mbomPicAddr",coltype:"input",coldisplay:"图纸地址",colwidth:150,collang:"zh_cn",colselectid:"0",colfix:0},{colkey:"mbomPicVer",coltype:"number",coldisplay:"图纸版本",colwidth:150,collang:"zh_cn",colselectid:"0",colfix:0},{colkey:"mbomShipname",coltype:"input",coldisplay:"船级社编号",colwidth:150,collang:"zh_cn",colselectid:"0",colfix:0},{colkey:"mbomPlanUser",coltype:"input",coldisplay:"计划编制人",colwidth:150,collang:"zh_cn",colselectid:"0",colfix:0},{colkey:"mbomMoCode",coltype:"input",coldisplay:"工单编号",colwidth:150,collang:"zh_cn",colselectid:"0",colfix:0},{colkey:"mbomSingleQuantity",coltype:"number",coldisplay:"单台套数",colwidth:150,collang:"zh_cn",colselectid:"0",colfix:0},{colkey:"mbomNodeType",coltype:"input",coldisplay:"节点类型",colwidth:150,collang:"zh_cn",colselectid:"0",colfix:0},{colkey:"mbomNestImpt",coltype:"input",coldisplay:"套料重要度",colwidth:150,collang:"zh_cn",colselectid:"0",colfix:0},{colkey:"mbomShape",coltype:"input",coldisplay:"形状",colwidth:150,collang:"zh_cn",colselectid:"0",colfix:0},{colkey:"mbomShapeSpec",coltype:"input",coldisplay:"形状规格",colwidth:150,collang:"zh_cn",colselectid:"0",colfix:0}],collapseTitle:[],bottom:[{title:"套料信息",detail:[],type:"normal",footer:!0},{title:"钢板信息",detail:[],type:"collapse",footer:!1},{title:"切割信息",detail:[],type:"normal",footer:!1},{title:"位置信息",detail:[],type:"normal",footer:!1}],bottomShowDetails:{nestInfo:[{key:"processStatusName",title:"状态",type:"input"},{key:"mbomCode",title:"物料号",type:"input"},{key:"nctaskName",title:"任务名称",type:"input"},{key:"proName",title:"程序名称",type:"input"},{key:"createUser",title:"套料员",type:"input"},{key:"updateTime",title:"套料时间",type:"input"},{key:"proUsedraterem",title:"去余利用率",type:"number"},{key:"partNestedsum",title:"套料数量",type:"number"},{key:"partArea",title:"净面积",type:"number"},{key:"partWeight",title:"净重量",type:"number"},{key:"partShareweight",title:"理论分摊",type:"number"},{key:"partTralshareweight",title:"实际分摊",type:"number"},{key:"proCutlength",title:"切割长度",type:"number"},{key:"proPiercessum",title:"穿孔总次数",type:"number"},{key:"proCuttime",title:"切割时间",type:"number"}],sheetInfo:[{key:"matName",title:"物资名称",type:"input"},{key:"matSheetType",title:"材料类型",type:"input"},{key:"wmsSpicAddr",title:"缩略图",type:"image"},{key:"matBarcode",title:"条形码",type:"input"},{key:"matStoreId",title:"库房",type:"input"},{key:"matStackId",title:"库位",type:"input"},{key:"matSerialno",title:"层号",type:"number"},{key:"matProjNo",title:"工程号",type:"input"},{key:"matMateCode",title:"物料编码",type:"input"},{key:"matMatCatName",title:"物资分类",type:"input"},{key:"matMataId",title:"材质",type:"input"},{key:"matThickness",title:"厚度",type:"number"},{key:"matLength",title:"长度",type:"number"},{key:"matWidth",title:"宽度",type:"number"},{key:"matAuxQuantity",title:"重量",type:"number"},{key:"matBatchNo",title:"炉批号",type:"input"}],cutInfo:[{key:"woPreStatusCn",title:"备料状态",type:"input"},{key:"isPreparationCn",title:"配送状态",type:"input"},{key:"woStatus",title:"切割状态",type:"input"},{key:"woReportStatus",title:"报工状态",type:"input"},{key:"partsReportReportNumber",title:"报工数量",type:"number"},{key:"partsReportScrappedNumber",title:"报废数量",type:"number"},{key:"proName",title:"程序名称",type:"input"},{key:"woTeamId",title:"班组",type:"input"},{key:"woEquipmentId",title:"设备",type:"input"},{key:"woCutter",title:"切割人员",type:"input"},{key:"woCutEndtime",title:"完工日期",type:"input"},{key:"ptmtOutBarcode",title:"钢板条形码",type:"input"},{key:"matBatchNo",title:"炉批号",type:"input"}],addrInfo:[{key:"wlpStoreId",title:"库房",type:"input"},{key:"wlpStackId",title:"库位",type:"input"},{key:"quantity",title:"数量",type:"number",value:1}]},showDetail:!1,showNestDiagram:!1,nestDiagramIndex:0,showNestNC:!1,showNestDetail:!1,nestProCode:"",nestDiagramList:[],nestNCList:[],ncHeight:400,nestDetailTitles:[{title:"套料板材",datas:[],headers:[{key:"proMatName",title:"套料钢板名",type:"input"},{key:"proMatSheettype",title:"材料类型",type:"input"},{key:"remStatus",title:"余料状态",type:"input"},{key:"proMatMaterial",title:"材质",type:"input"},{key:"proMatThickness",title:"厚度",type:"input"},{key:"proMatLength",title:"长度",type:"number"},{key:"proMatWidth",title:"宽度",type:"number"},{key:"proMatArea",title:"面积",type:"number"}]},{title:"零件汇总",datas:[],headers:[{key:"partField1",title:"项目号",type:"input"},{key:"partMbomCode",title:"物料编码",type:"input"},{key:"partDrawcode",title:"图号",type:"input"},{key:"partNestedsum",title:"套料数量",type:"number"},{key:"partArea",title:"净面积",type:"number"},{key:"partWeight",title:"净重量",type:"number"},{key:"partPiercessum",title:"穿孔数",type:"number"},{key:"partCutlength",title:"切割长度",type:"number"},{key:"partCuttime",title:"切割时间",type:"number"}]},{title:"零件明细",datas:[],headers:[{key:"partField1",title:"项目号",type:"input"},{key:"partMbomCode",title:"物料编码",type:"input"},{key:"partDrawcode",title:"图号",type:"input"},{key:"partlistRowcode",title:"唯一码",type:"input"},{key:"partlistCutrowid",title:"切割时序",type:"input"},{key:"partlistNestedsum",title:"套料数量",type:"input"},{key:"partArea",title:"净面积",type:"number"},{key:"partWeight",title:"净重量",type:"number"},{key:"partPiercessum",title:"穿孔数",type:"number"},{key:"partCutlength",title:"切割长度",type:"number"}]},{title:"截取余料",datas:[],headers:[{key:"remName",title:"余料名称",type:"input"},{key:"remMaterial",title:"材质",type:"input"},{key:"remThickness",title:"厚度",type:"number"},{key:"remLength",title:"长度",type:"number"},{key:"remWidth",title:"宽度",type:"number"},{key:"remArea",title:"面积",type:"number"},{key:"remWeight",title:"重量",type:"number"},{key:"remField1",title:"数据1",type:"input"},{key:"remField2",title:"数据2",type:"input"},{key:"remField3",title:"数据3",type:"input"},{key:"remField4",title:"数据4",type:"input"}]}],bodyheight:0,bodyWidth:0,top:0,tabsHeight:0,tabTitleHeight:0,tabsTop:0,tableHeight:0,tableTop:0,active:"",tabbarHeight:0,datas:[],loading:!1,finished:!1,isEmpty:!1,baseUrl:"",localNumberCol:{},btnmenusdata:{checkboxs:{},radio:""},detaildata:{},checkAll:!1,fixedField:{},cardField:[],hasSearchBottom:[!1,!1,!1,!1],imagetop:0,imageheight:0,showLoading:!1}},created:function(){this.showLoading=!0,this.init();var t=[];this.detailcols.forEach((function(e){var i=!1;t.forEach((function(t){t.colkey===e.colkey&&(i=!0)})),i||t.push(e)})),this.cols=t,this.search()},mounted:function(){this.initTabsHeight()},watch:{numberCol:{handler:function(t){var e={},i=this;t&&(Object.keys(t).forEach((function(n){t[n].forEach((function(t){e[t]=i.getAccuracy(n)}))})),this.$set(this,"localNumberCol",e)),this.$set(this,"localNumberCol",e)},immediate:!0},datas:{handler:function(t){this.localdatas=t},immediate:!0}},methods:{initTabsHeight:function(){var t=this;this.$nextTick((function(){t.imageheight=t.$refs.image.$el.offsetHeight;var e=window.innerHeight,i=t.$refs.navBar.$el.offsetHeight;t.bodyheight=e-i,t.bodyWidth=window.innerWidth,t.initNCHeight(),t.top=i,t.imagetop=i+t.bodyheight-t.imageheight-20;var n=t.$refs.cards.$el.offsetHeight,o=t.$refs.tabs.children[0].children[0].clientHeight;t.tabTitleHeight=o,t.tabsHeight=t.bodyheight-n-o-20,t.tabsTop=i+t.bodyheight-n,t.tableHeight=t.bodyheight-o-20,t.tableTop=i+o;var a=0;t.$refs.tabbar&&(a=t.$refs.tabbar[0].$el.offsetHeight),t.tabbarHeight=a}))},initNCHeight:function(){var t=window.innerHeight,e=this.$refs.navBar.$el.offsetHeight;this.ncHeight=t-e-20},initDetailTableHeight:function(){var t=window.innerHeight,e=this.$refs.navBar.$el.offsetHeight;this.tableHeight=t-e-this.tabTitleHeight-20,this.tableTop=e+this.tabTitleHeight},getAccuracy:function(t){var e={unitPriceAccuracy:"2",moneyAccuracy:"2",thicknessAccuracy:"2",quantityAccuracy:"2",otherAccuracy:"3",timeFormat:"Hm"};switch(t){case"0":return parseInt(e["unitPriceAccuracy"]);case"1":return parseInt(e["moneyAccuracy"]);case"2":return parseInt(e["thicknessAccuracy"]);case"3":return parseInt(e["quantityAccuracy"]);case"4":return parseInt(e["otherAccuracy"]);case"5":return e["timeFormat"];default:return 2}},numberFormat:function(t,e){if(void 0!==e&&""!==e&&null!==e){var i=this.getAccuracy(t);return Math.round(e*Math.pow(10,i))/Math.pow(10,i)}},formTime:function(t,e){if(Math.floor(e),"Hm"===t){var i=Math.floor(e/3600),n=Math.floor(e%3600/60),o=Math.floor(e%3600%60);return e="",i>0&&(e+=i+"H"),n>0&&(e+=n+"m"),e||(e=o>0?"1m":"0m"),e}if("Hms"===t){var a=Math.floor(e/3600),l=Math.floor(e%3600/60),r=Math.floor(e%3600%60);return e="",a>0&&(e+=a+"H"),l>0&&(e+=l+"m"),r>0&&(e+=r+"s"),e||(e="0s"),e}return e},onClickLeft:function(){this.$router.go(-1)},onLoad:function(){this.refreshing&&(this.refreshing=!1),this.loading=!1},initPartView:function(){var t=this,e=this.queryParams,i=[],n={};this.myAjax(this.btnMethod.queryPartInfoMethod,"",e,(function(o){null!=o.data.data&&(n=o.data.data,n.barcode=e.field2,i.push(n),t.datas=i,0===i.length?t.isEmpty=!0:t.isEmpty=!1)}))},initNestView:function(){var t=this;this.showLoading=!0;var e=this.queryParams,i={},n=this;this.myAjax(this.btnMethod.queryNestInfoMethod,"",e,(function(e){i=e.data.data;var o="";null==i?t.bottomShowDetails.nestInfo.forEach((function(t){t.value=""})):t.bottomShowDetails.nestInfo.forEach((function(t){Reflect.ownKeys(i).forEach((function(e){t.key===e&&("number"===t.type?t.value=n.numberFormat("4",i[e]):t.value=i[e]),"proCode"===e&&(o=i[e])}))})),t.bottom[0].detail=t.bottomShowDetails.nestInfo,t.nestProCode=o,t.showLoading=!1,t.hasSearchBottom[0]=!0}))},initSheetView:function(){var t=this;this.showLoading=!0;var e=this.queryParams,i=this;this.myAjax(this.btnMethod.querySheetInfoMethod,"",e,(function(e){var n=[];Object.assign(n,t.bottomShowDetails.sheetInfo);var o=e.data.data,a=[];if(null==o||o===[]){var l={};n.forEach((function(t){t.value=""})),l.showValues=n,a.push(l)}else o.forEach((function(t){var e={},o=[];n.forEach((function(n){Reflect.ownKeys(t).forEach((function(a){n.key===a&&("number"===n.type?n.value=i.numberFormat("4",t[a]):n.value=t[a]),"matName"===a&&(o.push(t[a]),e.title=t[a]),"id"===a&&(e.id=t[a])}))})),e.showValues=n,a.push(e)}));t.showLoading=!1,t.bottom[1].detail=a,t.hasSearchBottom[1]=!0}))},initCutView:function(){var t=this;this.showLoading=!0;var e=this.queryParams,i=this,n={};this.myAjax(this.btnMethod.queryCutInfoMethod,"",e,(function(e){n=e.data.data;var o=t.bottomShowDetails.cutInfo;null==n||n===[]?o.forEach((function(t){t.value=""})):o.forEach((function(t){Reflect.ownKeys(n).forEach((function(e){t.key===e&&("number"===t.type?t.value=i.numberFormat("4",n[e]):t.value=n[e])}))})),t.showLoading=!1,t.bottom[2].detail=o,t.hasSearchBottom[2]=!0}))},initAddrView:function(){var t=this;this.showLoading=!0;var e=this.queryParams,i={},n=this;this.myAjax(this.btnMethod.queryAddrInfoMethod,"",e,(function(e){i=e.data.data;var o=t.bottomShowDetails.addrInfo;null==i||i===[]?o.forEach((function(t){t.value=""})):o.forEach((function(t){Reflect.ownKeys(i).forEach((function(e){t.key===e&&("number"===t.type?t.value=n.numberFormat("4",i[e]):t.value=i[e])}))})),t.showLoading=!1,t.bottom[3].detail=o,t.hasSearchBottom[3]=!0}))},initNestDiagram:function(){var t=this,e={};e.facId=this.queryParams.field1,e.picFileBussid=this.nestProCode,e.picFileBusstype="NESTFILE",e.picFileLast="1";var i=[];this.myAjax(this.btnMethod.queryNestDiagramAndNCMethod,"",e,(function(e){e.data.data.forEach((function(e){i.push(t.baseUrl+e.picFileUrl)})),t.nestDiagramList=i,t.nestDiagramList.length>0?t.showNestDiagram=!0:t.$toast({message:"未查到套料图"})}))},initNestNC:function(){var t=this,e={};e.facId=this.queryParams.field1,e.picFileBussid=this.nestProCode,e.picFileBusstype="NCFILE",e.picFileLast="1";var i=[];this.myAjax(this.btnMethod.queryNestDiagramAndNCMethod,"",e,(function(e){e.data.data.forEach((function(t){i.push(t["picFileFileid"])})),t.nestNCList=i,t.nestNCList.length>0?t.showNestNC=!0:t.$toast({message:"未查到NC"})}))},fomatFloat:function(t,e){if(void 0!==e&&""!==e&&null!==e){var i=2;return i=this.localNumberCol[t]?this.localNumberCol[t]:this.getAccuracy("4"),"string"==typeof i?this.formTime(i,e):Math.round(e*Math.pow(10,i))/Math.pow(10,i)}},openDetail:function(t){this.showDetail=!0,this.detaildata=t},openNestDiagram:function(){this.initNestDiagram()},openNestNC:function(){this.initNestNC(),this.initNCHeight()},openNestDetail:function(){this.showbody=!1,""===this.nestProCode?this.$toast({message:"未查到零件信息"}):(this.initDetailView(),this.initDetailTableHeight())},close:function(t){t.flag=!1,this.showDetail=!1},closeNestDiagram:function(t){t.flag=!1,this.showNestDiagram=!1},closeNestNC:function(t){t.flag=!1,this.showNestNC=!1},closeNestDetail:function(t){t.flag=!1,this.showNestDetail=!1,this.showbody=!0},initDetailView:function(){this.initSheetDetailView(),this.initPartSumView(),this.initPartDetailView(),this.initRemDetailView(),this.showNestDetail=!0},initSheetDetailView:function(){var t=this,e={};e.field1=this.queryParams.field1,e.field2=this.nestProCode;var i=this;this.myAjax(this.btnMethod.querySheetDetailMethod,"",e,(function(e){var n=[],o=[];Object.assign(n,t.nestDetailTitles[0].headers),e.data.data.forEach((function(t){var e={};n.forEach((function(n){Reflect.ownKeys(t).forEach((function(o){var a;n.key===o&&(a="number"===n.type?i.numberFormat("4",t[o]):t[o],e[o]=a)}))})),o.push(e)})),t.nestDetailTitles[0].datas=o}))},initPartSumView:function(){var t=this,e={};e.field1=this.queryParams.field1,e.field2=this.nestProCode;var i=this;this.myAjax(this.btnMethod.queryPartSumMethod,"",e,(function(e){var n=[],o=[];Object.assign(n,t.nestDetailTitles[1].headers),e.data.data.forEach((function(t){var e={};n.forEach((function(n){Reflect.ownKeys(t).forEach((function(o){var a;n.key===o&&(a="number"===n.type?i.numberFormat("4",t[o]):t[o],e[o]=a)}))})),o.push(e)})),t.nestDetailTitles[1].datas=o}))},initPartDetailView:function(){var t=this,e={};e.field1=this.queryParams.field1,e.field2=this.nestProCode;var i=this;this.myAjax(this.btnMethod.queryPartDetailMethod,"",e,(function(e){var n=[],o=[];Object.assign(n,t.nestDetailTitles[2].headers),e.data.data.forEach((function(t){var e={};n.forEach((function(n){Reflect.ownKeys(t).forEach((function(o){var a;n.key===o&&(a="number"===n.type?i.numberFormat("4",t[o]):t[o],e[o]=a)}))})),o.push(e)})),t.nestDetailTitles[2].datas=o}))},initRemDetailView:function(){var t=this,e={};e.field1=this.queryParams.field1,e.field2=this.nestProCode;var i=this;this.myAjax(this.btnMethod.queryRemDetailMethod,"",e,(function(e){var n=[],o=[];Object.assign(n,t.nestDetailTitles[3].headers),e.data.data.forEach((function(t){var e={};n.forEach((function(n){Reflect.ownKeys(t).forEach((function(o){var a;n.key===o&&(a="number"===n.type?i.numberFormat("4",t[o]):t[o],e[o]=a)}))})),o.push(e)})),t.nestDetailTitles[3].datas=o}))},buttonsClick:function(t){this.$emit("buttonsClick",t)},closeDetail:function(){this.showDetail=!1},footIconClick:function(t){this.$emit("footIconClick",t)},init:function(){var t=localStorage.getItem("serviceCfg");if(t){var e=JSON.parse(t),i=e.facObj;e.cloudObj;!0===i.isDefault&&(this.baseUrl="http://"+i.ip+":"+i.port)}""!==this.baseUrl&&null!=this.baseUrl||(this.baseUrl="http://"+window.location.host);var n=[];this.cardcols.forEach((function(t){var e=!1;n.forEach((function(i){i.key===t.key&&(e=!0)})),e||n.push(t)}));var o={},a=[];n.forEach((function(t){0===t.position?a.push(t):1===t.position?o["fixed1"]=t:2===t.position?o["fixed2"]=t:3===t.position?o["fixed3"]=t:4===t.position?o["fixed4"]=t:5===t.position&&(o["fixed5"]=t)})),this.fixedField=o,this.cardField=a},search:function(){this.initPartView(),this.initNestView()},bottomTabsClick:function(t,e){this.showLoading=!1,!0!==this.hasSearchBottom[t]&&(0===t?this.initNestView():1===t?this.initSheetView():2===t?this.initCutView():3===t&&this.initAddrView())},myAjax:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(t){},a=arguments.length>5?arguments[5]:void 0,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"post",r="",s=localStorage.getItem("serviceCfg");if(s){var c=JSON.parse(s),d=c.facObj;c.cloudObj;!0===d.isDefault&&(r="http://"+d.ip+":"+d.port)}""==r&&(r="http://"+window.location.host);var h=u["a"].create();h({method:l,url:r+e+t,data:i,headers:{"Content-Type":"application/json; charset=utf-8",xs_view:a,access_token:localStorage.getItem("token"),token_uuid:localStorage.getItem("token_uuid")}}).then((function(t){n(t)})).catch((function(t){o(t)}))}},computed:{tableKV:function(){var t=this,e={};return Object.keys(this.selectItems).forEach((function(i){if(t.selectItems[i]&&"object"==Object(r["a"])(t.selectItems[i])){var n={};t.selectItems[i].forEach((function(t){n[t.id]=t.name})),e[i]=n}})),e}}},A=M,F=(i("ddd7"),Object(y["a"])(A,a,l,!1,null,"5f414676",null)),H=F.exports,I={name:"partHistory",components:{historyPage:H},data:function(){return{queryParams:{field1:"",field2:""},showLeftArrow:!1,btnMethod:{queryPartInfoMethod:"/nest/nestmbom/queryMbomByUnicode",queryNestInfoMethod:"/nest/nestprogram/queryprogramByUnicode",querySheetInfoMethod:"/nest/cutworkorder/queryParentMatInfoByUnicode",queryCutInfoMethod:"/nest/cutworkorder/queryCutInfoByUnicode",queryAddrInfoMethod:"/nest/nestwiplineparts/queryLocationByUnicode",queryNestDiagramAndNCMethod:"/nest/nestpicfile/getpicfileargsUnAuth",querySheetDetailMethod:"/nest/nestprogrammat/queryNestMatByProCode",queryPartSumMethod:"/nest/nestparts/queryNestPartsByProCode",queryPartDetailMethod:"/nest/nestpartlist/queryNestPartsListByProCode",queryRemDetailMethod:"/nest/nestrem/queryNestRemListByProCode"},baseUrl:"",screenHeight:0,show:!0}},methods:{isPC:function(){var t={versions:function(){var t=navigator.userAgent;navigator.appVersion;return{trident:t.indexOf("Trident")>-1,presto:t.indexOf("Presto")>-1,webKit:t.indexOf("AppleWebKit")>-1,gecko:t.indexOf("Gecko")>-1&&-1==t.indexOf("KHTML"),mobile:!!t.match(/AppleWebKit.*Mobile.*/),ios:!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:t.indexOf("Android")>-1||t.indexOf("Linux")>-1,iPhone:t.indexOf("iPhone")>-1,iPad:t.indexOf("iPad")>-1,webApp:-1==t.indexOf("Safari")}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()};return!(t.versions.mobile||t.versions.ios||t.versions.android||t.versions.iPhone||t.versions.iPad)}},beforeCreate:function(){document.title=this.$t("partHistory.docTitle")},created:function(){this.queryParams.field1=this.$route.query.facId,this.queryParams.field2=this.$route.query.code;var t=this.$route.query.showBack;t&&(this.showLeftArrow=t);var e=this;e.screenHeight=window.innerHeight;var i=window.innerWidth;if(e.screenHeight>i){var n=document.documentElement.clientWidth||document.body.clientWidth,o=document.getElementsByTagName("html")[0];o.style.fontSize=n/20+"px"}else{var a=document.documentElement.clientWidth||document.body.clientWidth,l=document.getElementsByTagName("html")[0];l.style.fontSize=a/60+"px"}if(e.$nextTick((function(){e.$refs.historyPage.initTabsHeight()})),window.onresize=function(){e.screenHeight=window.innerHeight;var t=window.innerWidth;if(e.isPC()){document.documentElement.clientWidth||document.body.clientWidth;var i=document.getElementsByTagName("html")[0];i.style.fontSize="16px"}else if(e.screenHeight>t){var n=document.documentElement.clientWidth||document.body.clientWidth,o=document.getElementsByTagName("html")[0];o.style.fontSize=n/20+"px"}else{var a=document.documentElement.clientWidth||document.body.clientWidth,l=document.getElementsByTagName("html")[0];l.style.fontSize=a/60+"px"}e.$refs.historyPage.$refs.nestDiagramPage&&e.$refs.historyPage.$refs.nestDiagramPage.blankPageMounted(),e.$refs.historyPage.$refs.showDetail&&e.$refs.historyPage.$refs.showDetail.blankPageMounted(),e.$refs.historyPage.$refs.nestNCPage&&(e.$refs.historyPage.$refs.nestNCPage.blankPageMounted(),e.$refs.historyPage.$refs.ncText&&e.$refs.historyPage.initNCHeight()),e.$refs.historyPage.$refs.nestDetailPage&&(e.$refs.historyPage.$refs.nestDetailPage.blankPageMounted(),e.$refs.historyPage.initDetailTableHeight()),e.$nextTick((function(){e.$refs.historyPage.initTabsHeight()}))},this.isPC()){document.documentElement.clientWidth||document.body.clientWidth;var r=document.getElementsByTagName("html")[0];r.style.fontSize="16px"}"undefined"!==typeof api&&api.setScreenOrientation({orientation:"auto"})},destroyed:function(){"undefined"!==typeof api&&api.setScreenOrientation({orientation:"portrait_up"}),window.onresize=null;var t=document.documentElement.clientWidth||document.body.clientWidth,e=document.documentElement.clientHeight||document.body.clientHeight,i=t>e?e:t,n=document.getElementsByTagName("html")[0];n.style.fontSize=i/20+"px"},activated:function(){}},E=I,$=Object(y["a"])(E,n,o,!1,null,"6f64719e",null);e["default"]=$.exports}}]);